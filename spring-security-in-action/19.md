# 리액티브 앱을 위한 스프링 시큐리티

- 일부 하위 작업에 동시에 접근하도록 작업을 나눌 수 있어 데이터를 더 빨리 받을 수 있다.
- 리액티브 앱은 다르게 디자인 됐기 때문에 시큐리티도 구현 방식을 다르게 조정한다.

## 19.1. 리액티브 앱이란?

- 앱이 명령형 방식으로 전체 데이터를 한 번에 처리한다.
- 앱이 리액티브 방식으로 데이터를 조각으로 받고 처리한다.
    - 모든 파일을 받을 때까지 기다리지 않고 처리를 시작한다.
- 리액티브 스트림 사양
    - 리액티브 앱을 구현할 수 있게 비동기식 스트림 처리의 표준을 제시한다.
    - 구현 중 하나가 프로젝트 리액터이며 함수형 API를 제공한다.
- Mono
    - 리액터 구현이 정의하는 핵심 개념 중 하나
    - 단일 값을 위한 게시자
- flux
    - 다중 값을 위한 게시자
- 내부적으로 리액티브 구현은 스트림을 해결하기 위해 여러 스레드를 이용한다.
    - 즉, 기존처럼 요청당 한 스레드의 철학이 더는 해당되지 않는다.
- SecurityContext
    - ThreadLocal에 기반을 두는데 이제 요청당 두 개 이상의 스레드가 사용되므로 리액티브에서는 똑같이 동작하지 않는다.
    - 따라서 권한 부여 구성도 영향을 받는다.
        - 권한 부여 규칙은 SecurityContext.Authentication에 의존하기 때문이다.

## 19.2. 리액티브 앱에서의 사용자 관리

- Mono<UserDetails>를 반환한다.
- ReactiveAuthenticationManager가 인증 논리를 구현한다.

## 19.3. 리액티브 앱에서 권한 부여 규칙 구성

### 19.3.1. 리액티브 앱의 엔드포인트 계층에 권한 부여 적용

- AuthorizationWebFilter가 권한 부여 책임을 ReactiveAuthorizationManager에 위임한다.
- authorizeRequests()가 아닌 authorizeExchange()를 이용한다.

### 19.3.2. 리액티브 앱에 메서드 보안 적용

- PreAuthorize, PostAuthorize만 이용할 수 있다.

### 19.4. 리액티브 앱과 OAuth 2

