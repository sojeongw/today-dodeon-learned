# 전역 메서드 보안: 사전 및 사후 필터링

- 메서드 호출은 허용하면서도 규칙을 따르는지 확인하거나 승인된 반환값만 받을 수 있게 할 때 사용한다.
- 사전 필터링: 메서드를 호출하기 전에 매개 변수의 값을 필터링 한다.
- 사후 필터링: 메서드를 호출한 후 반환된 값을 필터링 한다.
- 컬렉션과 배열에만 사용할 수 있다.
- 호출 권한 부여와 마찬가지로 애스팩트로 필터링을 구현한다.
    - 새로 만들어 반환하는 게 아니라 주어진 컬렉션을 변경하기 때문에 컬렉션이 변경 불가능하진 않은지 확인해야 한다.
    - 변경 불가능한 컬렉션을 제공하면 예외가 발생한다.

## 17.1. 메서드 권한 부여를 위한 사전 필터링 적용

- @Prefilter를 사용한다.
- 주어진 기준을 충족하지 않는 값을 필터링하고 충족하는 값으로만 메서드를 호출한다.

## 17.2. 메서드 권한 부여를 위한 사후 필터링 적용

- @PostFilter를 사용한다.
- 호출하는 사람이 자신의 정보만 얻을 수 있게 한다.

## 17.3. 스프링 데이터 리포지토리에 필터링 이용

- 리포지토리 메서드에 @PostFilter를 적용하는 것은 성능 관점에서 좋지 않다.
    - 모든 레코드를 가지온 후 직접 필터링 해야 해서 OOM이 발생할 수 있다.
    - 처음부터 필요한 것만 검색하는 것이 성능 면에서 유리하다.